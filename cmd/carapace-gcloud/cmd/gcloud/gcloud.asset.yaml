# yaml-language-server: $schema=https://carapace.sh/schemas/command.json
name: asset
description: Manage the Cloud Asset Inventory.
commands:
    - name: analyze-iam-policy
      description: Analyzes IAM policies that match a request.
      flags:
        --access-time=: The hypothetical access timestamp to evaluate IAM conditions.
        --analyze-service-account-impersonation: If true, the response will include access analysis from identities to resources via service account impersonation.
        --execution-timeout=: The amount of time the executable has to complete.
        --expand-groups: If true, the identities section of the result will expand any Google groups appearing in an IAM policy binding.
        --expand-resources: If true, the resource section of the result will expand any resource attached to an IAM policy to include resources lower in the resource hierarchy.
        --expand-roles: If true, the access section of result will expand any roles appearing in IAM policy bindings to include their permissions.
        --folder=: Folder ID on which to perform the analysis.
        --full-resource-name=: The full resource name.
        --identity=: The identity appearing in the form of principals in the IAM policy binding.
        --no-analyze-service-account-impersonation&: If true, the response will include access analysis from identities to resources via service account impersonation.
        --no-expand-groups&: If true, the identities section of the result will expand any Google groups appearing in an IAM policy binding.
        --no-expand-resources&: If true, the resource section of the result will expand any resource attached to an IAM policy to include resources lower in the resource hierarchy.
        --no-expand-roles&: If true, the access section of result will expand any roles appearing in IAM policy bindings to include their permissions.
        --no-output-group-edges&: If true, the result will output the relevant membership relationships between groups.
        --no-output-resource-edges&: If true, the result will output the relevant parent/child relationships between resources.
        --no-show-response&: If true, the response will be showed as-is in the command output.
        --organization=: Organization ID on which to perform the analysis.
        --output-group-edges: If true, the result will output the relevant membership relationships between groups.
        --output-resource-edges: If true, the result will output the relevant parent/child relationships between resources.
        --permissions=: The permissions to appear in the result.
        --roles=: The roles to appear in the result.
        --saved-analysis-query=: The name of a saved query.
        --show-response: If true, the response will be showed as-is in the command output.
    - name: analyze-iam-policy-longrunning
      description: Analyzes IAM policies that match a request asynchronously and writes the results to Google Cloud Storage or BigQuery destination.
      flags:
        --access-time=: The hypothetical access timestamp to evaluate IAM conditions.
        --analyze-service-account-impersonation: If true, the response will include access analysis from identities to resources via service account impersonation.
        --bigquery-dataset=!: BigQuery dataset where the results will be written.
        --bigquery-partition-key=: This enum determines the partition key column for the bigquery tables.
        --bigquery-table-prefix=!: The prefix of the BigQuery tables to which the analysis results will be written.
        --bigquery-write-disposition=: Specifies the action that occurs if the destination table or partition already exists.
        --expand-groups: If true, the identities section of the result will expand any Google groups appearing in an IAM policy binding.
        --expand-resources: If true, the resource section of the result will expand any resource attached to an IAM policy to include resources lower in the resource hierarchy.
        --expand-roles: If true, the access section of result will expand any roles appearing in IAM policy bindings to include their permissions.
        --folder=: Folder ID on which to perform the analysis.
        --full-resource-name=: The full resource name.
        --gcs-output-path=: Google Cloud Storage URI where the results will be written.
        --identity=: The identity appearing in the form of principals in the IAM policy binding.
        --no-analyze-service-account-impersonation&: If true, the response will include access analysis from identities to resources via service account impersonation.
        --no-expand-groups&: If true, the identities section of the result will expand any Google groups appearing in an IAM policy binding.
        --no-expand-resources&: If true, the resource section of the result will expand any resource attached to an IAM policy to include resources lower in the resource hierarchy.
        --no-expand-roles&: If true, the access section of result will expand any roles appearing in IAM policy bindings to include their permissions.
        --no-output-group-edges&: If true, the result will output the relevant membership relationships between groups.
        --no-output-resource-edges&: If true, the result will output the relevant parent/child relationships between resources.
        --organization=: Organization ID on which to perform the analysis.
        --output-group-edges: If true, the result will output the relevant membership relationships between groups.
        --output-resource-edges: If true, the result will output the relevant parent/child relationships between resources.
        --permissions=: The permissions to appear in the result.
        --roles=: The roles to appear in the result.
      completion:
        flag:
            bigquery-partition-key:
                - PARTITION_KEY_UNSPECIFIED
                - REQUEST_TIME
    - name: analyze-move
      description: Analyzes resource move.
      flags:
        --blockers-only=: Determines whether to perform analysis against blockers only.
        --destination-folder=: The destination folder ID to perform the analysis.
        --destination-organization=: The destination organization ID to perform the analysis.
    - name: analyze-org-policies
      description: Analyze organization policies under a scope.
      flags:
        --constraint=!: The name of the constraint to analyze organization policies for.
        --filter=: Apply a Boolean filter _EXPRESSION_ to each resource item to be listed.
        --limit=: Maximum number of resources to list.
        --page-size=: Some services group resource list output into pages.
        --scope=!: Scope can only be an organization.
        --sort-by=: Comma-separated list of resource field key names to sort by.
    - name: analyze-org-policy-governed-assets
      description: Analyze organization policies governed assets under a scope.
      flags:
        --constraint=!: The name of the constraint to analyze organization policies for.
        --filter=: Apply a Boolean filter _EXPRESSION_ to each resource item to be listed.
        --limit=: Maximum number of resources to list.
        --page-size=: Some services group resource list output into pages.
        --scope=!: Scope can only be an organization.
        --sort-by=: Comma-separated list of resource field key names to sort by.
    - name: analyze-org-policy-governed-containers
      description: Analyze organization policies governed containers under a scope.
      flags:
        --constraint=!: The name of the constraint to analyze organization policies for.
        --filter=: Apply a Boolean filter _EXPRESSION_ to each resource item to be listed.
        --limit=: Maximum number of resources to list.
        --page-size=: Some services group resource list output into pages.
        --scope=!: Scope can only be an organization.
        --sort-by=: Comma-separated list of resource field key names to sort by.
    - name: export
      description: Export the cloud assets to Google Cloud Storage/BigQuery.
      flags:
        --asset-types=: A list of asset types (i.e., "compute.googleapis.com/Disk") to take a snapshot.
        --bigquery-dataset=: The id of the BigQuery dataset.
        --bigquery-table=!: ID of the table or fully qualified identifier for the table.
        --content-type=: Asset content type.
        --folder=: The ID of the folder which is the root asset.
        --no-output-bigquery-force&: If the destination table already exists and this flag is specified, the table will be overwritten by the contents of assets snapshot.
        --no-per-asset-type&: If the flag is specified, the snapshot results will be written to one or more tables, each of which contains results of one asset type.
        --organization=: The ID of the organization which is the root asset.
        --output-bigquery-force: If the destination table already exists and this flag is specified, the table will be overwritten by the contents of assets snapshot.
        --output-path-prefix=: Google Cloud Storage URI where the results will go.
        --output-path=: Google Cloud Storage URI where the results will go.
        --partition-key=: If specified.
        --per-asset-type: If the flag is specified, the snapshot results will be written to one or more tables, each of which contains results of one asset type.
        --relationship-types=: A list of relationship types (i.e., "INSTANCE_TO_INSTANCEGROUP") to take a snapshot.
        --snapshot-time=: Timestamp to take a snapshot on assets.
      completion:
        flag:
            content-type:
                - resource
                - iam-policy
                - org-policy
                - access-policy
                - os-inventory
                - relationship
            partition-key:
                - read-time
                - request-time
    - name: feeds
      description: Manage Cloud Asset Inventory feeds.
      commands:
        - name: create
          description: Create a Cloud Asset Inventory Feed.
          flags:
            --asset-names=: A comma-separated list of the full names of the assets to receive updates.
            --asset-types=: A comma-separated list of types of the assets types to receive updates.
            --condition-description=: Description of the feed condition.
            --condition-expression=: Feed condition expression.
            --condition-title=: Title of the feed condition.
            --content-type=: Asset content type.
            --folder=: Folder of the feed.
            --organization=: Organization of the feed.
            --pubsub-topic=!: Name of the Cloud Pub/Sub topic to publish to, of the form `projects/PROJECT_ID/topics/TOPIC_ID`.
            --relationship-types=: A comma-separated list of the relationship types (i.e., "INSTANCE_TO_INSTANCEGROUP") to receive updates.
          completion:
            flag:
                content-type:
                    - resource
                    - iam-policy
                    - org-policy
                    - access-policy
                    - os-inventory
                    - relationship
        - name: delete
          description: Delete a Cloud Asset Inventory Feed.
          flags:
            --folder=: Folder of the feed.
            --organization=: Organization of the feed.
        - name: describe
          description: Describe a Cloud Asset Inventory Feed.
          flags:
            --folder=: Folder of the feed.
            --organization=: Organization of the feed.
        - name: list
          description: List Cloud Asset Inventory Feeds.
          flags:
            --folder=: Folder of the feed.
            --organization=: Organization of the feed.
        - name: update
          description: Update an existing Cloud Asset Inventory Feed.
          flags:
            --add-asset-names=: Append the given values to the current assetNames.
            --add-asset-types=: Append the given values to the current assetTypes.
            --add-relationship-types=: Append the given values to the current relationshipTypes.
            --clear-asset-names: Empty the current assetNames.
            --clear-asset-types: Empty the current assetTypes.
            --clear-condition-description: Clear any existing condition description setting on the feed.
            --clear-condition-expression: Clear any existing condition expression setting on the feed.
            --clear-condition-title: Clear any existing condition title setting on the feed.
            --clear-content-type: Clear any existing content type setting on the feed.
            --clear-relationship-types: Empty the current relationshipTypes.
            --condition-description=: Condition description to overwrite the existing one.
            --condition-expression=: Condition expression to overwrite the existing one.
            --condition-title=: Condition title to overwrite the existing one.
            --content-type=: Asset content type to overwrite the existing one.
            --folder=: Folder of the feed.
            --no-clear-asset-names&: Empty the current assetNames.
            --no-clear-asset-types&: Empty the current assetTypes.
            --no-clear-condition-description&: Clear any existing condition description setting on the feed.
            --no-clear-condition-expression&: Clear any existing condition expression setting on the feed.
            --no-clear-condition-title&: Clear any existing condition title setting on the feed.
            --no-clear-content-type&: Clear any existing content type setting on the feed.
            --no-clear-relationship-types&: Empty the current relationshipTypes.
            --organization=: Organization of the feed.
            --pubsub-topic=: Name of the Cloud Pub/Sub topic to publish to, of the form `projects/PROJECT_ID/topics/TOPIC_ID`.
            --remove-asset-names=: Remove the given values from the current assetNames.
            --remove-asset-types=: Remove the given values from the current assetTypes.
            --remove-relationship-types=: Remove the given values from the current relationshipTypes.
          completion:
            flag:
                content-type:
                    - resource
                    - iam-policy
                    - org-policy
                    - access-policy
                    - os-inventory
                    - relationship
    - name: get-effective-iam-policy
      description: Get effective IAM policies for a specified list of resources within accessible scope, such as a project, folder or organization.
      flags:
        --names=!: Names refer to a list of
        --scope=!: Scope can be a project, a folder, or an organization.
    - name: get-history
      description: Get the update history of assets that overlaps a time window.
      flags:
        --asset-names=!: A list of full names of the assets to get the history for.
        --content-type=!: Asset content type.
        --end-time=: End time of the time window (exclusive) for the asset history.
        --organization=: The ID of the organization which is the root asset.
        --relationship-types=: A list of relationship types (i.e., "INSTANCE_TO_INSTANCEGROUP") to take a snapshot.
        --start-time=!: Start time of the time window (inclusive) for the asset history.
      completion:
        flag:
            content-type:
                - resource
                - iam-policy
                - org-policy
                - access-policy
                - os-inventory
                - relationship
    - name: list
      description: List the Cloud assets.
      flags:
        --asset-types=: A list of asset types (i.e., "compute.googleapis.com/Disk") to take a snapshot.
        --content-type=: Asset content type.
        --filter=: Apply a Boolean filter _EXPRESSION_ to each resource item to be listed.
        --folder=: The ID of the folder which is the root asset.
        --limit=: Maximum number of resources to list.
        --organization=: The ID of the organization which is the root asset.
        --page-size=: Some services group resource list output into pages.
        --relationship-types=: A list of relationship types (i.e., "INSTANCE_TO_INSTANCEGROUP") to take a snapshot.
        --snapshot-time=: Timestamp to take a snapshot on assets.
        --sort-by=: Comma-separated list of resource field key names to sort by.
      completion:
        flag:
            content-type:
                - resource
                - iam-policy
                - org-policy
                - access-policy
                - os-inventory
                - relationship
    - name: operations
      description: Manage Cloud Asset Inventory operations.
      commands:
        - name: describe
          description: Describe a Cloud Asset Inventory operation.
    - name: query
      description: Query the Cloud assets.
      flags:
        --bigquery-dataset=: The id of the BigQuery dataset.
        --bigquery-table=!: ID of the table or fully qualified identifier for the table.
        --end-time=: End time of the time window (exclusive) for the asset history.
        --folder=: The ID of the folder which is the root asset.
        --job-reference=: Reference to the query job, which is from the previous call.
        --organization=: The ID of the organization which is the root asset.
        --page-size=: The maximum number of rows to return in the results.
        --page-token=: A page token received from previous call.
        --snapshot-time=: Timestamp to take a snapshot on assets.
        --start-time=!: Start time of the time window (inclusive) for the asset history.
        --statement=: A BigQuery Standard SQL compatible statement.
        --timeout=: Maximum amount of time that the client will wait for the query to complete.
        --write-disposition=: Specifies the action that occurs if the destination table or partition already exists.
      completion:
        flag:
            write-disposition:
                - write-append
                - write-empty
                - write-truncate
    - name: saved-queries
      description: Manage Cloud Asset Inventory saved queries.
      commands:
        - name: create
          description: Create a Cloud Asset Inventory saved query.
          flags:
            --description=: A string describing the query.
            --folder=: Folder of the saved query.
            --labels=: List of label KEY=VALUE pairs to add.
            --organization=: Organization of the saved query.
            --query-file-path=!: Path to JSON or YAML file that contains the query.
        - name: delete
          description: Delete a Cloud Asset Inventory saved query.
          flags:
            --folder=: Folder of the saved query.
            --organization=: Organization of the saved query.
        - name: describe
          description: Describe a Cloud Asset Inventory saved query.
          flags:
            --folder=: Folder of the saved query.
            --organization=: Organization of the saved query.
        - name: list
          description: List Cloud Asset Inventory saved query.
          flags:
            --folder=: Folder of the saved query.
            --organization=: Organization of the saved query.
        - name: update
          description: Update an existing Cloud Asset Inventory saved query.
          flags:
            --clear-labels: Remove all labels.
            --description=: A string describing the query.
            --folder=: Folder of the saved query.
            --no-clear-labels&: Remove all labels.
            --organization=: Organization of the saved query.
            --query-file-path=: Path to JSON or YAML file that contains the query.
            --remove-labels=: List of label keys to remove.
            --update-labels=: List of label KEY=VALUE pairs to update.
    - name: search-all-iam-policies
      description: Searches all IAM policies within the specified accessible scope, such as a project, folder or organization.
      flags:
        --asset-types=: List of asset types that the IAM policies are attached to.
        --filter=: Apply a Boolean filter _EXPRESSION_ to each resource item to be listed.
        --limit=: Maximum number of resources to list.
        --order-by=: Comma-separated list of fields specifying the sorting order of the
        --page-size=: Some services group resource list output into pages.
        --query=: Query statement.
        --scope=: Scope can be a project, a folder, or an organization.
        --sort-by=: Comma-separated list of resource field key names to sort by.
    - name: search-all-resources
      description: Searches all Cloud resources within the specified accessible scope, such as a project, folder or organization.
      flags:
        --asset-types=: A list of asset types that this request searches for.
        --filter=: Apply a Boolean filter _EXPRESSION_ to each resource item to be listed.
        --limit=: Maximum number of resources to list.
        --order-by=: A comma-separated list of fields specifying the sorting order of the
        --page-size=: Some services group resource list output into pages.
        --query=: The query statement.
        --read-mask=: A comma-separated list of fields specifying which fields to be returned
        --scope=: A scope can be a project, a folder, or an organization.
        --sort-by=: Comma-separated list of resource field key names to sort by.
